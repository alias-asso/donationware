name: Tests
permissions:
  contents: read

on:
  workflow_dispatch:
  push:

jobs:
  validate-kickstart:
    name: Validate Kickstart File
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Anaconda Kickstart Validator
        run: |
          pip install pykickstart

      - name: Validate ks.cfg
        run: |
          ksvalidator pxe/fedora/ks.cfg

  validate-grub-config:
    name: Validate GRUB Configuration
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install GRUB2 tools
        run: |
          sudo apt update
          sudo apt install -y grub2-common

      - name: Validate GRUB configuration
        run: |
          grub-script-check pxe/grub.cfg

  validate-reporter-build:
    name: Validate Reporter Build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v3

      - name: Install dependencies
        run: |
          npm install --prefix reporter

      - name: Run build
        run: |
          npm run build --prefix reporter
